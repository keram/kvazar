	// var kQuiz = {	// 		// 	// 	kQuiz: function () { return this; }	// 		// };	var opera = (navigator.userAgent.indexOf("Opera") != -1) ? true : false;	var ff = (navigator.userAgent.indexOf("Firefox") != -1) ? true : false;	var msie = /*@cc_on!@*/false;	var msieold = false;	if (msie) {		msieold = (typeof window.XMLHttpRequest == -1) ? false : true;	}			var kQuiz = function(config) {	var kQuiz = { 						updateSnippet: function (id, html) {				$("#" + id).html(html);			},			submitCallback: function (response) {				kQuiz.form_submitted = true;				if ( kQuiz.question.type != "multi" ) {					$('#qform :input').attr('disabled', false);					$("#frmqform-useranswer").focus(); // v opere nefunguje priamo				}				return true;			}, // End of callback						submit: function () {				if ( $("#frmqform-useranswer") && $("#frmqform-useranswer").val() == "" ) {					$("#frmqform-useranswer").focus();										return false;				} else if ( kQuiz.question.type == "multi"  && $('#qform :input:checkbox:checked').length == 0  ) {					alert("!");										return false;				}				var send_values = {};				var values = $("#qform").serializeArray();				// todo lepsi selektor cez childs formu				// $('#qform :input').attr('disabled', true);												for (var i = 0; i < values.length; i++) {					var name = values[i].name;					// multi					if (name in send_values) {						var val = send_values[name];						if (!(val instanceof Array)) {							val = [val];						}						val.push(values[i].value);						send_values[name] = val;					} else {						send_values[name] = values[i].value;					}				}				jQuery.ajax({					url: $("#qform").attr("action"),					data: send_values,					type: $("#qform").attr("method"),					success: kQuiz.submitCallback				});								return true;			}, // End of processAnswer			quizCountDown: function () {				var elm = $("#quiz-countdown"); // todo toto je blbost na entu				var timer_val = parseInt(elm.html());				if ( timer_val != 0  && !isNaN(timer_val)) {					elm.html(timer_val - 1)				} else {					clearInterval(kQuiz.cdi); // Queiz CountDownInterval					$.getJSON(kQuiz.url, null, kQuiz.initData);				}				return true;			}, // End of countDown						questionCountDown: function () {				var elm = $("#question-timer"); // todo toto je blbost na entu				var timer_val = parseInt(elm.html());								if ( timer_val != 0  && !isNaN(timer_val)) {					elm.html(timer_val - 1)				} else {					clearInterval(kQuiz.qcdi); // questionCountDownInterval				}								return true;			}, // End of countDown												initData: function (data) {				if (data.snippets) {					for (var i in data.snippets ) {						kQuiz.updateSnippet(i, data.snippets[i]);					}		 		}								if ( data.quiz ) 				{					var q = data.quiz;					if ( q.run == 1 )					{						if ( typeof(kQuiz.run) == "undefined" ) {							kQuiz.run = 1;							$("#qform").submit( 								function() {									kQuiz.submit();										return false;								}							);						}												if ( data.question ) {							kQuiz.initQuestion(data.question);						}					} 					else if ( q.remaining_time < 300 ) 					{						$("#quiz-countdown").html(q.remaining_time);						kQuiz.cdi = setInterval(kQuiz.quizCountDown, 1000);					}					else 					{					 //  kviz nebezi a zaroven je predpokladany cas do spustenia viac ako 5 minut poslem request za polovicu stavajuceho casu						setTimeout(function() { $.getJSON(kQuiz.url, null, kQuiz.initData); }, Math.round( (q.remaining_time * 1000) / 2) );					}				}				return true;			}, // End of initData			initHint: function (response) {				if (response.hint) {					if ( kQuiz.question.type == "multi" )					{						var elms = $("#frmqform-answer"+response.hint);						elms.parent().addClass("invalid");						// $("#frmqform-answer"+response.hint).attr('disabled', true);					}					else 					{						$("#frmqform-answer").val(response.hint);					}										// fix pre nadbytocny request sposobeny zaokruhlenim nadol pre rychlejsie vykonanie hintu					if ( !response.hints ) {						clearInterval(kQuiz.hint_int);					}				}				return true;			}, // End of initHint			getHint: function () {				$.getJSON(kQuiz.hint_url + kQuiz.question.id, null, kQuiz.initHint);				return true;			}, // End of getHint			initAnswer: function (response) {				if (response.answer) {					if ( kQuiz.question.type == "multi" )					{						// TODO nejaky lepsi selektor na moznosti, ( podla classy? )						var answers = response.answer;						var elms = $("#qform :input:checkbox");						for ( var i = 0; i < elms.length; i++ ) {							if ( answers.indexOf(elms[i].value) != -1 ) {								$(elms[i]).parent().addClass("correct");								if ( elms[i].checked ) {									$(elms[i]).parent().addClass("valid-checked");								}							} else {								$(elms[i]).parent().addClass("invalid");								if ( elms[i].checked ) {									$(elms[i]).parent().addClass("invalid-checked");								}							}						}					}					else 					{						$("#frmqform-answer").val(response.answer);					}				}				setTimeout(function() { $.getJSON(kQuiz.url, null, kQuiz.initData); } , 3000);								return true;			}, // End of initAnswer			getAnswer: function () {				clearInterval(kQuiz.hint_int);				$.getJSON(kQuiz.answer_url + kQuiz.question.id, null, kQuiz.initAnswer);				return true;			}, // End of getAnswer						initQuestion: function (question) {				kQuiz.question = question;				kQuiz.form_submitted = false;				$("#question-timer").html(kQuiz.question.remaining_time);				kQuiz.qcdi = setInterval(kQuiz.questionCountDown, 1000);				if ( kQuiz.question.hints != 0) {					var hp = Math.round(( kQuiz.question.remaining_time / 100 ) * ( 100 / ( kQuiz.question.hints + 1 ) ));					kQuiz.hint_int = setInterval(kQuiz.getHint, hp * 1000);				}								if ( typeof(kQuiz.question_answer_timeout) != "undefined" ) {					clearTimeout(kQuiz.question_answer_timeout);				}								console.log(kQuiz.question.remaining_time);								kQuiz.question_answer_timeout = setTimeout(kQuiz.getAnswer, (kQuiz.question.remaining_time * 1000));			},				init: function(config) {				this.url = ( config.url ) ? config.url : null;				this.hint_url = ( config.hint_url ) ? config.hint_url : null;				this.answer_url = ( config.answer_url ) ? config.answer_url : null;				this.initData(config);			}		};			kQuiz.init(config);		return kQuiz;	};$(function () {		if ( !msieold ) 	{		if ( typeof(quiz_config) != "undefined" ) {			var myQuiz = new kQuiz(quiz_config);		}			// // kazdych 30 sekund updatnem pocet prihlasenych ludi		// if ($("#logged-users")) {		// 	var refreshId = setInterval(function()		// 	{		// 		$.get('/?do=loggedUsers');		// 	}, 60000);		// }	}	else 	{		alert("Your browser does not support the full functionality of this application.");	}});